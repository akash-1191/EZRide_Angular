<div class="min-h-screen bg-gray-50 p-4 md:p-6">
    <!-- Header -->
    <div class="mb-6">
        <h1 class="text-2xl md:text-3xl font-bold text-gray-800">
            <i class="fas fa-road mr-2 text-blue-600"></i>Current Trips Details
        </h1>
        <p class="text-gray-600 mt-2">View and manage all Booking trips </p>
    </div>

    <!-- Stats Cards -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
        <div class="bg-white rounded-xl shadow-sm p-4 border border-gray-200">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-gray-600 text-sm">Total Trips</p>
                    <p class="text-2xl font-bold text-gray-800">{{ trips.length }}</p>
                </div>
                <i class="fas fa-truck text-blue-500 text-2xl"></i>
            </div>
        </div>

        <div class="bg-white rounded-xl shadow-sm p-4 border border-gray-200">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-gray-600 text-sm">Bike Trips</p>
                    <p class="text-2xl font-bold text-gray-800">
                        {{ getBikeTripsCount() }}
                    </p>
                </div>
                <i class="fas fa-motorcycle text-green-500 text-2xl"></i>
            </div>
        </div>

        <div class="bg-white rounded-xl shadow-sm p-4 border border-gray-200">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-gray-600 text-sm">Car Trips</p>
                    <p class="text-2xl font-bold text-gray-800">
                        {{ getCarTripsCount() }}
                    </p>
                </div>
                <i class="fas fa-car text-purple-500 text-2xl"></i>
            </div>
        </div>
    </div>

    <!-- Messages -->
    <div *ngIf="successMessage" class="mb-4 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded">
        <i class="fas fa-check-circle mr-2"></i>{{ successMessage }}
    </div>

    <div *ngIf="errorMessage" class="mb-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded">
        <i class="fas fa-exclamation-circle mr-2"></i>{{ errorMessage }}
    </div>

    <!-- Filters Section -->
    <div class="bg-white rounded-xl shadow-sm p-4 md:p-6 mb-6 border border-gray-200">
        <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-4">
            <h2 class="text-lg font-semibold text-gray-800">
                <i class="fas fa-filter mr-2 text-gray-600"></i>Filters
            </h2>
            <div class="flex gap-3">
                <button (click)="refreshData()"
                    class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm cursor-pointer">
                    <i class="fas fa-sync-alt mr-2"></i>Refresh
                </button>
                <button (click)="resetFilters()"
                    class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors text-sm cursor-pointer">
                    <i class="fas fa-times mr-2"></i>Clear Filters
                </button>
            </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <!-- Search -->
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">
                    <i class="fas fa-search mr-2 text-gray-500"></i>Search
                </label>
                <input type="text" [(ngModel)]="searchTerm" (ngModelChange)="applyFilters()"
                    placeholder="Search by driver, customer, phone, vehicle..."
                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent cursor-pointer">
            </div>

            <!-- Vehicle Type Filter -->
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">
                    <i class="fas fa-car mr-2 text-gray-500"></i>Vehicle Type
                </label>
                <select [(ngModel)]="selectedVehicleType" (ngModelChange)="applyFilters()"
                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent cursor-pointer">
                    <option value="all">All Vehicles</option>
                    <option value="Bike">Bike</option>
                    <option value="Car">Car</option>
                </select>
            </div>

            <!-- Status Filter -->
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">
                    <i class="fas fa-user-check mr-2 text-gray-500"></i>Driver Status
                </label>
                <select [(ngModel)]="selectedStatus" (ngModelChange)="applyFilters()"
                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent cursor-pointer">
                    <option value="all">All Status</option>
                    <option value="Assigned">Assigned</option>
                    <option value="InProgress">InProgress</option>
                    <option value="Completed">Completed</option>
                </select>
            </div>
        </div>
    </div>

    <!-- Loading State -->
    <div *ngIf="isLoading" class="flex justify-center items-center py-12">
        <div class="text-center">
            <i class="fas fa-spinner fa-spin text-blue-500 text-4xl mb-4"></i>
            <p class="text-gray-600">Loading trips data...</p>
        </div>
    </div>

    <!-- Table Section -->
    <div *ngIf="!isLoading" class="bg-white rounded-xl shadow-sm overflow-hidden border border-gray-200">
        <!-- Table Header -->
        <div class="p-4 border-b border-gray-200 bg-gray-50">
            <div class="flex justify-between items-center">
                <h2 class="text-lg font-semibold text-gray-800">
                    <i class="fas fa-list mr-2 text-gray-600"></i>Trips List
                    <span class="text-sm text-gray-500 ml-2">({{ filteredTrips.length }} records)</span>
                </h2>
                <div class="text-sm text-gray-600">
                    Showing {{ getPaginatedTrips().length }} of {{ filteredTrips.length }}
                </div>
            </div>
        </div>

        <!-- Table -->
        <div class="overflow-x-auto">
            <table class="w-full">
                <thead class="bg-gray-50">
                    <tr class="border-b border-gray-200">
                        <th class="py-3 px-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">
                            <i class="fas fa-user mr-1"></i> Driver
                        </th>
                        <th class="py-3 px-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">
                            <i class="fas fa-car mr-1"></i> Vehicle
                        </th>
                        <th class="py-3 px-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">
                            <i class="fas fa-users mr-1"></i> Customer
                        </th>
                        <th class="py-3 px-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">
                            <i class="fas fa-clock mr-1"></i> Trip Time
                        </th>
                        <th class="py-3 px-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">
                            <i class="fas fa-info-circle mr-1"></i> Status
                        </th>
                        <th class="py-3 px-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">
                            <i class="fas fa-tasks mr-1"></i> Action
                        </th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-gray-200">
                    <tr *ngFor="let trip of getPaginatedTrips()" class="hover:bg-gray-100 transition-colors">
                        <!-- Driver Info -->
                        <td class="py-4 px-4">
                            <div class="flex items-center">
                                <div
                                    class="shrink-0 h-10 w-10 bg-blue-100 rounded-full flex items-center justify-center">
                                    <i class="fas fa-user text-blue-600"></i>
                                </div>
                                <div class="ml-4">
                                    <div class="text-sm font-medium text-gray-900">{{ trip.driverFullName || 'N/A' }}
                                    </div>
                                    <div class="text-sm text-gray-500">
                                        <i class="fas fa-phone mr-1 text-gray-400"></i>{{ trip.driverPhone || 'N/A' }}
                                        <br>
                                        <i class="fas fa-envelope mr-2 text-gray-400 w-4"></i>{{ trip.driverEmail ||
                                        'N/A' }}
                                    </div>
                                </div>
                            </div>
                        </td>

                        <!-- Vehicle Info -->
                        <td class="py-4 px-4">
                            <div class="space-y-1">
                                <div class="flex items-center">
                                    <span [ngClass]="getVehicleTypeClass(trip.vehicleType)"
                                        class="px-2 py-1 text-xs font-medium rounded-full">
                                        {{ trip.vehicleType || 'N/A' }}
                                    </span>
                                </div>
                                <div class="text-sm text-gray-900">
                                    {{ trip.bikeName || trip.carName || 'N/A' }}
                                </div>
                                <div class="text-sm text-gray-500">
                                    <i class="fas fa-id-card mr-1 text-gray-400"></i>{{ trip.registrationNo || 'N/A' }}
                                </div>
                            </div>
                        </td>

                        <!-- Customer Info -->
                        <td class="py-4 px-4">
                            <div class="space-y-1">
                                <div class="text-sm font-medium text-gray-900">{{ trip.customerFullName || 'N/A' }}
                                </div>
                                <div class="text-sm text-gray-500">
                                    <i class="fas fa-phone mr-1 text-gray-400"></i>{{ trip.customerPhone || 'N/A' }}
                                    <i class="fas fa-city mr-1 text-gray-400"></i>{{ trip.customerCity || 'N/A' }}
                                </div>

                                <div class="text-sm text-gray-500">
                                    <i class="fas fa-envelope mr-2 text-gray-400 w-4"></i>{{ trip.uesrEmail ||
                                    trip.userEmail || 'N/A' }}
                                </div>
                            </div>
                        </td>

                        <!-- Trip Time -->
                        <td class="py-4 px-4">
                            <div class="space-y-2">
                                <div class="text-sm">
                                    <span class="font-medium text-gray-700">Start:</span>
                                    <span class="text-gray-900 ml-2">{{ formatDate(trip.startTime) }}</span>
                                </div>
                                <div class="text-sm">
                                    <span class="font-medium text-gray-700">End:</span>
                                    <span class="text-gray-900 ml-2">{{ formatDate(trip.endTime) }}</span>
                                </div>
                            </div>
                        </td>

                        <!-- Status -->
                        <td class="py-4 px-4">
                            <span [ngClass]="getStatusClass(trip.status)"
                                class="px-3 py-1 text-xs font-medium rounded-full">
                                {{ trip.status || 'N/A' }}
                            </span>
                        </td>
                        <!-- Action -->
                        <td class="py-4 px-4">
                            <button (click)="updateStatusCompleted(trip.driverBookingId)"
                                [disabled]="trip.status === 'Completed'" class="px-4 py-2 bg-gray-600 text-white rounded-lg
           hover:bg-gray-700 transition-colors text-sm cursor-pointer
           disabled:bg-gray-400 disabled:cursor-not-allowed">
                                Completed
                            </button>
                        </td>
                    </tr>

                    <!-- Empty State -->
                    <tr *ngIf="filteredTrips.length === 0">
                        <td colspan="5" class="py-12 text-center">
                            <i class="fas fa-inbox text-gray-400 text-4xl mb-4"></i>
                            <p class="text-gray-600">No trips found</p>
                            <p class="text-gray-500 text-sm mt-1">Try adjusting your filters or refresh the data</p>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Pagination -->
        <div *ngIf="filteredTrips.length > 0" class="px-4 py-3 border-t border-gray-200 bg-gray-50">
            <div class="flex flex-col md:flex-row md:items-center md:justify-between">
                <div class="text-sm text-gray-700 mb-4 md:mb-0">
                    Page {{ currentPage }} of {{ totalPages }}
                </div>
                <div class="flex items-center space-x-2">
                    <button (click)="prevPage()" [disabled]="currentPage === 1" [class.opacity-50]="currentPage === 1"
                        class="px-3 py-1 border border-gray-300 rounded hover:bg-gray-100 text-sm cursor-pointer"
                        [class.cursor-not-allowed]="currentPage === 1">
                        <i class="fas fa-chevron-left mr-1"></i> Previous
                    </button>

                    <div class="flex space-x-1">
                        <button *ngFor="let page of getPageNumbers()" (click)="goToPage(page)" [ngClass]="{
                      'bg-blue-600 text-white': currentPage === page,
                      'bg-white': currentPage !== page
                    }" class="px-3 py-1 border border-gray-300 rounded hover:bg-gray-100 text-sm cursor-pointer">
                            {{ page }}
                        </button>
                    </div>

                    <button (click)="nextPage()" [disabled]="currentPage === totalPages"
                        [class.opacity-50]="currentPage === totalPages"
                        class="px-3 py-1 border border-gray-300 rounded hover:bg-gray-100 text-sm cursor-pointer"
                        [class.cursor-not-allowed]="currentPage === totalPages">
                        Next <i class="fas fa-chevron-right ml-1"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>