<div class="bg-white shadow-md rounded-lg overflow-x-auto">
    <div class="flex justify-between items-center px-4 py-3 border-b">
        <h2 class="text-xl font-semibold text-gray-800 flex items-center">
            <i class="fas fa-receipt text-gray-800 text-xl mr-2"></i> Your Booking Payment Details
        </h2>

        <div class="relative filter-container">
            <button class="text-gray-600 hover:text-gray-900 focus:outline-none flex items-center cursor-pointer"
                (click)="toggleFilterDropdown()">
                <i class="fas fa-filter text-xl"></i>
                <span class="ml-1 text-sm font-medium capitalize">{{ selectedFilter || 'Filter' }}</span>
            </button>

            <!-- Filter dropdown -->
            <div *ngIf="showFilterDropdown"
                class="absolute right-0 mt-2 w-48 bg-gray-900 border text-white border-gray-200 rounded shadow-md z-50">
                <ul class="text-sm">
                    <li *ngFor="let type of filterTypes" (click)="applyFilter(type)"
                        class="px-4 py-2 hover:bg-gray-700 cursor-pointer capitalize border">
                        {{ type }}
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <!-- Responsive Table Wrapper -->
    <div class="w-full overflow-x-auto">
        <table class="min-w-full text-sm text-left text-gray-700">
            <thead class="bg-gray-100 text-gray-600 uppercase text-xs">
                <tr>
                    <th class="px-4 py-3">#</th>
                    <th class="px-4 py-3">Vehicle Name</th>
                    <th class="px-4 py-3">Vehicle Type</th>
                    <th class="px-4 py-3">Start Time</th>
                    <th class="px-4 py-3">End Time</th>
                    <th class="px-4 py-3">Total Amount</th>
                    <th class="px-4 py-3">Security Deposit</th>
                    <th class="px-4 py-3">Payment Status</th>
                    <th class="px-4 py-3">Action</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let item of filteredDetails; let i = index" class="border-t hover:bg-gray-50 transition">
                    <td class="px-4 py-3">{{ i + 1 }}</td>
                    <td class="px-4 py-3">{{ item.vehicleName }}</td>
                    <td class="px-4 py-3">{{ item.vehicleType }}</td>
                    <td class="px-4 py-3">{{ item.startTime | date: 'short' }}</td>
                    <td class="px-4 py-3">{{ item.endTime | date: 'short' }}</td>
                    <td class="px-4 py-3">₹{{ item.totalAmount }}</td>
                    <td class="px-4 py-3">₹{{ item.securityDepositAmount }}</td>
                    <td class="px-4 py-3">
                        <span class="inline-block px-2 py-1 rounded-full text-xs font-semibold" [ngClass]="{
                'bg-green-100 text-green-700': item.paymentStatus === 'Success',
                'bg-yellow-100 text-yellow-700': item.paymentStatus === 'Pending',
                'bg-red-100 text-red-700': item.paymentStatus === 'Failed',
                'bg-gray-200 text-gray-700': item.paymentStatus === 'Not Paid'
              }">
                            {{ item.paymentStatus }}
                        </span>
                    </td>
                    <td class="px-4 py-3">
                        <!-- Show Pay Now if Not Paid and date is in future -->
                        <button *ngIf="item.paymentStatus === 'Not Paid' && isFutureDate(item.endTime)"
                            (click)="submitPayment(item)" class="bg-gradient-to-r cursor-pointer from-indigo-500 via-purple-500 to-pink-500
                            hover:from-pink-600 hover:to-red-600 text-white font-semibold text-xs px-4 py-2 rounded-md
                            shadow-md transition duration-300 ease-in-out">
                            <i class="fas fa-wallet mr-1"></i> Pay Now
                        </button>
                        <!-- Show rignicon Done if Success and date passed -->
                        <span *ngIf="item.paymentStatus === 'Success'" class="text-green-600 text-xl">
                            <i class="fas fa-check-circle"></i>
                        </span>

                        <!-- Show closeicon Close if Not Paid and date has passed -->
                        <span *ngIf="item.paymentStatus === 'Not Paid' && !isFutureDate(item.endTime)"
                            class="text-red-600 text-xl">
                            <i class="fas fa-times-circle"></i>
                        </span>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <ng-template #noData>
        <div class="p-4 text-center text-gray-600">No booking records found.</div>
    </ng-template>
</div>
